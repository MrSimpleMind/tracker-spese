<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#2563eb">
    <meta name="description" content="Tracker spese famiglia - Gestisci le spese di famiglia in modo semplice">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Spese">
    <link rel="manifest" href="/tracker-spese/manifest.json">
    <link rel="apple-touch-icon" href="/tracker-spese/icon-192.png">
    <title>Tracker Spese Famiglia</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- React e ReactDOM DEVONO essere caricati PRIMA -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Chart.js per i grafici -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.js"></script>
    
    <style>
        body { 
            font-family: system-ui, -apple-system, sans-serif;
            overscroll-behavior: none;
        }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .badge { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.7; } }
    </style>
</head>
<body class="bg-gray-50">
    <div id="root"></div>
    
    <!-- Fallback se non carica -->
    <noscript>
        <div style="text-align: center; padding: 50px;">
            <h1>‚ö†Ô∏è JavaScript richiesto</h1>
            <p>Abilita JavaScript nel tuo browser per usare l'app</p>
        </div>
    </noscript>

    <!-- Configurazione Firebase e PWA -->
    <script type="text/babel" src="/tracker-spese/js/firebase-config.js"></script>
    
    <!-- Componenti React -->
    <script type="text/babel" src="/tracker-spese/js/components/LoginPage.js"></script>
    <script type="text/babel" src="/tracker-spese/js/components/SpeseView.js"></script>
    <script type="text/babel" src="/tracker-spese/js/components/CategorieView.js"></script>
    <script type="text/babel" src="/tracker-spese/js/components/ReminderView.js"></script>
    <script type="text/babel" src="/tracker-spese/js/components/AnalyticsView.js"></script>
    
    <!-- Modali -->
    <script type="text/babel" src="/tracker-spese/js/modals/AddSpesaModal.js"></script>
    <script type="text/babel" src="/tracker-spese/js/modals/EditSpesaModal.js"></script>
    <script type="text/babel" src="/tracker-spese/js/modals/GraficoAndamentoModal.js"></script>
    <script type="text/babel" src="/tracker-spese/js/modals/AddCategoriaModal.js"></script>
    <script type="text/babel" src="/tracker-spese/js/modals/EditCategoriaModal.js"></script>
    <script type="text/babel" src="/tracker-spese/js/modals/AddReminderModal.js"></script>
    <script type="text/babel" src="/tracker-spese/js/modals/EditReminderModal.js"></script>
    
    <!-- App principale -->
    <script type="text/babel" src="/tracker-spese/js/components/App.js"></script>
    
    <!-- Inizializzazione App -->
    <script type="text/babel">
        // Verifica che tutte le librerie siano caricate
        setTimeout(() => {
            if (typeof React === 'undefined' || typeof ReactDOM === 'undefined' || typeof firebase === 'undefined') {
                document.getElementById('root').innerHTML = `
                    <div style="text-align: center; padding: 50px; font-family: system-ui;">
                        <h1 style="color: #dc2626; font-size: 2rem;">‚ùå Errore di Caricamento</h1>
                        <p style="color: #6b7280; margin: 20px 0;">Le librerie non si sono caricate correttamente.</p>
                        <p style="color: #6b7280; margin: 10px 0;"><strong>Controlla:</strong></p>
                        <ul style="color: #6b7280; text-align: left; max-width: 400px; margin: 20px auto;">
                            <li>‚úì Connessione internet attiva</li>
                            <li>‚úì Browser aggiornato (Chrome/Safari consigliati)</li>
                            <li>‚úì Nessun blocco di contenuti/ad-blocker</li>
                        </ul>
                        <button onclick="location.reload()" style="background: #2563eb; color: white; padding: 12px 24px; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; margin-top: 20px;">
                            üîÑ Riprova
                        </button>
                    </div>
                `;
                return;
            }
            
            // Tutto caricato correttamente, inizializza l'app
            const root = ReactDOM.createRoot(document.getElementById('root'));
            root.render(<App />);
        }, 2000);
    </script>
</body>
</html>
